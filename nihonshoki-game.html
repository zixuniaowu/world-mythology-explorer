<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>日本書紀クエスト - 歴史探索ゲーム</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', 'MS Mincho', sans-serif;
            background: linear-gradient(135deg, #2c1810 0%, #4a2c1f 100%);
            color: #f5e6d3;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* ゲームコンテナ */
        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        /* ヘッダー */
        .game-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            border: 2px solid #d4a574;
        }

        .game-title {
            font-size: 3em;
            color: #ffd700;
            margin-bottom: 10px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.7);
            font-family: 'MS Mincho', serif;
        }

        .game-subtitle {
            font-size: 1.3em;
            color: #d4a574;
        }

        /* ゲームボード */
        .game-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
            padding: 30px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
        }

        /* 時代カード */
        .era-card {
            background: linear-gradient(135deg, #4a2c1f 0%, #6b3e2a 100%);
            border: 3px solid #d4a574;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .era-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 215, 0, 0.2) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .era-card:hover::before {
            opacity: 1;
        }

        .era-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.3);
        }

        .era-card.completed {
            background: linear-gradient(135deg, #2d5016 0%, #3d6b1f 100%);
            border-color: #4caf50;
        }

        .era-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .era-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .era-name {
            font-size: 1.2em;
            color: #ffd700;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .era-period {
            font-size: 0.9em;
            color: #d4a574;
        }

        /* クイズモーダル */
        .quiz-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            overflow-y: auto;
        }

        .quiz-content {
            max-width: 800px;
            margin: 50px auto;
            background: linear-gradient(135deg, #2c1810 0%, #4a2c1f 100%);
            border: 3px solid #d4a574;
            border-radius: 15px;
            padding: 30px;
            position: relative;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 2em;
            color: #d4a574;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close-btn:hover {
            color: #ffd700;
        }

        .quiz-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .quiz-title {
            font-size: 2em;
            color: #ffd700;
            margin-bottom: 10px;
        }

        .question-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .question-text {
            font-size: 1.3em;
            color: #f5e6d3;
            margin-bottom: 20px;
            line-height: 1.8;
        }

        .answer-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .answer-btn {
            background: linear-gradient(135deg, #6b3e2a 0%, #8b5a3c 100%);
            border: 2px solid #d4a574;
            color: #f5e6d3;
            padding: 15px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
        }

        .answer-btn:hover {
            background: linear-gradient(135deg, #8b5a3c 0%, #a0714d 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(212, 165, 116, 0.3);
        }

        .answer-btn.correct {
            background: linear-gradient(135deg, #2d5016 0%, #3d6b1f 100%);
            border-color: #4caf50;
        }

        .answer-btn.incorrect {
            background: linear-gradient(135deg, #5d1616 0%, #7d2020 100%);
            border-color: #f44336;
        }

        /* 進行状況 */
        .progress-bar {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 25px;
            padding: 5px;
            margin-bottom: 30px;
        }

        .progress-fill {
            background: linear-gradient(90deg, #d4a574 0%, #ffd700 100%);
            height: 30px;
            border-radius: 20px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #2c1810;
        }

        /* スコア表示 */
        .score-display {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #4a2c1f 0%, #6b3e2a 100%);
            border: 2px solid #d4a574;
            padding: 15px 25px;
            border-radius: 25px;
            font-size: 1.2em;
            color: #ffd700;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }

        /* 戻るボタン */
        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 10px 20px;
            background: linear-gradient(135deg, #4a2c1f 0%, #6b3e2a 100%);
            color: #ffd700;
            border: 2px solid #d4a574;
            border-radius: 25px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .back-button:hover {
            background: linear-gradient(135deg, #6b3e2a 0%, #8b5a3c 100%);
            transform: translateY(-2px);
        }

        /* 結果画面 */
        .result-screen {
            text-align: center;
            padding: 30px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            margin-top: 30px;
        }

        .result-title {
            font-size: 2.5em;
            color: #ffd700;
            margin-bottom: 20px;
        }

        .result-text {
            font-size: 1.2em;
            color: #d4a574;
            margin-bottom: 30px;
        }

        .next-btn {
            padding: 15px 40px;
            background: linear-gradient(135deg, #d4a574 0%, #ffd700 100%);
            color: #2c1810;
            border: none;
            border-radius: 25px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .next-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.4);
        }

        /* レスポンシブ */
        @media (max-width: 768px) {
            .game-board {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .answer-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <a href="japanese-mythology-index.html" class="back-button">← 戻る</a>
    <div class="score-display">スコア: <span id="score">0</span></div>
    
    <div class="game-container">
        <div class="game-header">
            <h1 class="game-title">日本書紀クエスト</h1>
            <p class="game-subtitle">日本の歴史と神話を巡る時空の旅</p>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressBar" style="width: 0%">
                進行度: 0%
            </div>
        </div>

        <div class="game-board" id="gameBoard">
            <!-- 時代カードが動的に生成される -->
        </div>
    </div>

    <!-- クイズモーダル -->
    <div class="quiz-modal" id="quizModal">
        <div class="quiz-content">
            <span class="close-btn" onclick="closeQuiz()">&times;</span>
            <div class="quiz-header">
                <h2 class="quiz-title" id="quizTitle">神代の時代</h2>
            </div>
            
            <div class="question-container">
                <p class="question-text" id="questionText">
                    ここに質問が表示されます
                </p>
                <div class="answer-options" id="answerOptions">
                    <!-- 回答オプションが動的に生成される -->
                </div>
            </div>
            
            <div class="result-screen" id="resultScreen" style="display: none;">
                <h3 class="result-title" id="resultTitle">正解！</h3>
                <p class="result-text" id="resultText">
                    素晴らしい！あなたは神代の知識を持っています。
                </p>
                <button class="next-btn" onclick="nextQuestion()">次へ進む</button>
            </div>
        </div>
    </div>

    <script>
        // ゲームデータ
        const gameData = {
            currentEra: null,
            currentQuestion: 0,
            score: 0,
            completedEras: [],
            eras: [
                {
                    id: 'jindai',
                    name: '神代',
                    period: '天地開闢',
                    icon: '⛩️',
                    questions: [
                        {
                            text: '日本書紀によると、最初に現れた神は誰でしょうか？',
                            options: [
                                { text: '国常立尊', correct: true },
                                { text: 'イザナギ', correct: false },
                                { text: '天照大神', correct: false },
                                { text: 'スサノオ', correct: false }
                            ]
                        },
                        {
                            text: '日本書紀では、日本の国土を生んだ神々は？',
                            options: [
                                { text: '天照大神と月読命', correct: false },
                                { text: 'イザナギとイザナミ', correct: true },
                                { text: 'スサノオと櫛名田姫', correct: false },
                                { text: '大国主神と少彦名神', correct: false }
                            ]
                        }
                    ]
                },
                {
                    id: 'jinmu',
                    name: '神武天皇',
                    period: '初代天皇',
                    icon: '👑',
                    questions: [
                        {
                            text: '神武天皇が即位したとされる年は？',
                            options: [
                                { text: '紀元前660年', correct: true },
                                { text: '紀元前550年', correct: false },
                                { text: '紀元前770年', correct: false },
                                { text: '紀元前880年', correct: false }
                            ]
                        },
                        {
                            text: '神武天皇の東征の出発地は？',
                            options: [
                                { text: '出雲', correct: false },
                                { text: '日向', correct: true },
                                { text: '大和', correct: false },
                                { text: '伊勢', correct: false }
                            ]
                        }
                    ]
                },
                {
                    id: 'sujin',
                    name: '崇神天皇',
                    period: '第10代天皇',
                    icon: '🏛️',
                    questions: [
                        {
                            text: '崇神天皇の時代に起きた重要な出来事は？',
                            options: [
                                { text: '仏教の伝来', correct: false },
                                { text: '四道将軍の派遣', correct: true },
                                { text: '大化の改新', correct: false },
                                { text: '遣唐使の派遣', correct: false }
                            ]
                        }
                    ]
                },
                {
                    id: 'ojin',
                    name: '応神天皇',
                    period: '第15代天皇',
                    icon: '⚔️',
                    questions: [
                        {
                            text: '応神天皇の母親として有名な人物は？',
                            options: [
                                { text: '推古天皇', correct: false },
                                { text: '持統天皇', correct: false },
                                { text: '神功皇后', correct: true },
                                { text: '斉明天皇', correct: false }
                            ]
                        }
                    ]
                },
                {
                    id: 'yuryaku',
                    name: '雄略天皇',
                    period: '第21代天皇',
                    icon: '🗡️',
                    questions: [
                        {
                            text: '雄略天皇の時代の特徴は？',
                            options: [
                                { text: '中央集権の強化', correct: true },
                                { text: '仏教の公伝', correct: false },
                                { text: '遣隋使の派遣', correct: false },
                                { text: '律令制の確立', correct: false }
                            ]
                        }
                    ]
                },
                {
                    id: 'keitai',
                    name: '継体天皇',
                    period: '第26代天皇',
                    icon: '🌸',
                    questions: [
                        {
                            text: '継体天皇の即位の特徴は？',
                            options: [
                                { text: '幼少での即位', correct: false },
                                { text: '女帝として即位', correct: false },
                                { text: '地方から迎えられた', correct: true },
                                { text: '譲位による即位', correct: false }
                            ]
                        }
                    ]
                },
                {
                    id: 'kinmei',
                    name: '欽明天皇',
                    period: '第29代天皇',
                    icon: '📿',
                    questions: [
                        {
                            text: '欽明天皇の時代の重要な出来事は？',
                            options: [
                                { text: '大化の改新', correct: false },
                                { text: '仏教の公伝', correct: true },
                                { text: '平安京遷都', correct: false },
                                { text: '武家政権の成立', correct: false }
                            ]
                        }
                    ]
                },
                {
                    id: 'suiko',
                    name: '推古天皇',
                    period: '第33代天皇',
                    icon: '👸',
                    questions: [
                        {
                            text: '推古天皇の摂政として有名な人物は？',
                            options: [
                                { text: '蘇我馬子', correct: false },
                                { text: '聖徳太子', correct: true },
                                { text: '藤原鎌足', correct: false },
                                { text: '菅原道真', correct: false }
                            ]
                        }
                    ]
                }
            ]
        };

        // ゲームボードの初期化
        function initGameBoard() {
            const board = document.getElementById('gameBoard');
            board.innerHTML = '';
            
            gameData.eras.forEach((era, index) => {
                const card = document.createElement('div');
                card.className = 'era-card';
                
                // 最初の時代以外はロック
                if (index > 0 && !gameData.completedEras.includes(gameData.eras[index - 1].id)) {
                    card.classList.add('locked');
                }
                
                // 完了した時代
                if (gameData.completedEras.includes(era.id)) {
                    card.classList.add('completed');
                }
                
                card.innerHTML = `
                    <div class="era-icon">${era.icon}</div>
                    <div class="era-name">${era.name}</div>
                    <div class="era-period">${era.period}</div>
                `;
                
                card.onclick = () => selectEra(era, index);
                board.appendChild(card);
            });
            
            updateProgress();
        }

        // 時代を選択
        function selectEra(era, index) {
            // ロックされているかチェック
            if (index > 0 && !gameData.completedEras.includes(gameData.eras[index - 1].id)) {
                alert('前の時代をクリアしてください！');
                return;
            }
            
            // 既にクリアしている場合
            if (gameData.completedEras.includes(era.id)) {
                alert('この時代は既にクリアしています！');
                return;
            }
            
            gameData.currentEra = era;
            gameData.currentQuestion = 0;
            showQuiz();
        }

        // クイズを表示
        function showQuiz() {
            const modal = document.getElementById('quizModal');
            const era = gameData.currentEra;
            const question = era.questions[gameData.currentQuestion];
            
            document.getElementById('quizTitle').textContent = `${era.name} - ${era.period}`;
            document.getElementById('questionText').textContent = question.text;
            
            // 回答オプションを生成
            const optionsContainer = document.getElementById('answerOptions');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = 'answer-btn';
                btn.textContent = option.text;
                btn.onclick = () => checkAnswer(option, btn);
                optionsContainer.appendChild(btn);
            });
            
            // 結果画面を隠す
            document.getElementById('resultScreen').style.display = 'none';
            
            modal.style.display = 'block';
        }

        // 答えをチェック
        function checkAnswer(option, button) {
            const buttons = document.querySelectorAll('.answer-btn');
            buttons.forEach(btn => btn.onclick = null);
            
            if (option.correct) {
                button.classList.add('correct');
                gameData.score += 10;
                document.getElementById('score').textContent = gameData.score;
                showResult(true);
            } else {
                button.classList.add('incorrect');
                gameData.score = Math.max(0, gameData.score - 5);
                document.getElementById('score').textContent = gameData.score;
                
                // 正解を表示
                buttons.forEach(btn => {
                    if (btn.textContent === gameData.currentEra.questions[gameData.currentQuestion].options.find(o => o.correct).text) {
                        btn.classList.add('correct');
                    }
                });
                showResult(false);
            }
        }

        // 結果を表示
        function showResult(isCorrect) {
            const resultScreen = document.getElementById('resultScreen');
            const resultTitle = document.getElementById('resultTitle');
            const resultText = document.getElementById('resultText');
            
            if (isCorrect) {
                resultTitle.textContent = '正解！';
                resultText.textContent = '素晴らしい！歴史の知識が身についています。';
            } else {
                resultTitle.textContent = '惜しい！';
                resultText.textContent = '次回は正解できるよう頑張りましょう。';
            }
            
            resultScreen.style.display = 'block';
        }

        // 次の質問へ
        function nextQuestion() {
            gameData.currentQuestion++;
            
            if (gameData.currentQuestion < gameData.currentEra.questions.length) {
                showQuiz();
            } else {
                // 時代クリア
                gameData.completedEras.push(gameData.currentEra.id);
                closeQuiz();
                initGameBoard();
                
                if (gameData.completedEras.length === gameData.eras.length) {
                    showGameComplete();
                }
            }
        }

        // クイズを閉じる
        function closeQuiz() {
            document.getElementById('quizModal').style.display = 'none';
        }

        // 進行状況を更新
        function updateProgress() {
            const progress = (gameData.completedEras.length / gameData.eras.length) * 100;
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = progress + '%';
            progressBar.textContent = `進行度: ${Math.round(progress)}%`;
        }

        // ゲーム完了
        function showGameComplete() {
            alert(`おめでとうございます！\n全ての時代をクリアしました！\n最終スコア: ${gameData.score}点`);
        }

        // 初期化
        initGameBoard();
    </script>
</body>
</html>