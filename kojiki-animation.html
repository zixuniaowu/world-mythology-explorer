<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤äº‹è¨˜ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ - ç¥è©±ã®ç‰©èª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', 'MS Gothic', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #0f0f1e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* æ¡œã®è£…é£¾èƒŒæ™¯ */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(255, 192, 203, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 50%, rgba(255, 182, 193, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 1;
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        .header {
            background: linear-gradient(135deg, #ff6b9d 0%, #c44569 100%);
            padding: 20px 0;
            text-align: center;
            box-shadow: 0 4px 20px rgba(255, 107, 157, 0.3);
            position: relative;
            z-index: 10;
        }

        .header h1 {
            font-size: 2.5em;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            color: #ffe0ec;
        }

        /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒŠ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 2;
        }

        /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ãƒ†ãƒ¼ã‚¸ */
        .animation-stage {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            margin-bottom: 30px;
        }

        /* SVGã‚­ãƒ£ãƒ³ãƒã‚¹ */
        #animationCanvas {
            width: 100%;
            height: 500px;
            background: linear-gradient(to bottom, #87CEEB 0%, #98D8E8 100%);
            display: block;
        }

        /* ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« */
        .story-controls {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }

        .story-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .story-btn {
            padding: 15px 20px;
            background: linear-gradient(135deg, #ff6b9d 0%, #ff9999 100%);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(255, 107, 157, 0.3);
        }

        .story-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(255, 107, 157, 0.4);
        }

        .story-btn.active {
            background: linear-gradient(135deg, #c44569 0%, #a0522d 100%);
        }

        /* ãƒ—ãƒ¬ã‚¤ãƒãƒƒã‚¯ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« */
        .playback-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
        }

        .control-btn {
            padding: 10px 20px;
            background: #ff6b9d;
            border: none;
            border-radius: 25px;
            color: white;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .control-btn:hover {
            background: #c44569;
            transform: scale(1.05);
        }

        .control-btn:disabled {
            background: #888;
            cursor: not-allowed;
        }

        /* ã‚¹ãƒ”ãƒ¼ãƒ‰èª¿æ•´ */
        .speed-control {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #ff9999;
        }

        .speed-slider {
            width: 100px;
        }

        /* ãƒ†ã‚­ã‚¹ãƒˆè¡¨ç¤ºã‚¨ãƒªã‚¢ */
        .text-display {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }

        .scene-title {
            font-size: 1.5em;
            color: #ff9999;
            margin-bottom: 10px;
        }

        .scene-text {
            font-size: 1.1em;
            line-height: 1.8;
            color: #e0e0e0;
        }

        /* æˆ»ã‚‹ãƒœã‚¿ãƒ³ */
        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 10px 20px;
            background: white;
            color: #ff6b9d;
            border: 2px solid #ff6b9d;
            border-radius: 25px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s ease;
            z-index: 100;
        }

        .back-button:hover {
            background: #ff6b9d;
            color: white;
        }

        /* æ¡œã®èŠ±ã³ã‚‰ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        .sakura-petal {
            position: fixed;
            color: #ffb7c5;
            font-size: 20px;
            animation: fall linear infinite;
            z-index: 1;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
        @media (max-width: 768px) {
            #animationCanvas {
                height: 300px;
            }
            
            .story-selector {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <a href="japanese-mythology-index.html" class="back-button">â† æˆ»ã‚‹</a>

    <div class="header">
        <h1>å¤äº‹è¨˜ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</h1>
        <p>æ—¥æœ¬ç¥è©±ã®ç‰©èªã‚’ç«æŸ´äººã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã§ä½“é¨“</p>
    </div>

    <div class="container">
        <!-- ã‚¹ãƒˆãƒ¼ãƒªãƒ¼é¸æŠ -->
        <div class="story-controls">
            <h2 style="color: #ff9999; margin-bottom: 15px;">ç‰©èªã‚’é¸æŠ</h2>
            <div class="story-selector">
                <button class="story-btn active" onclick="selectStory('amaterasu')">å¤©ç…§å¤§ç¥ã®å²©æˆ¸éš ã‚Œ</button>
                <button class="story-btn" onclick="selectStory('yamata')">ãƒ¤ãƒã‚¿ãƒã‚ªãƒ­ãƒé€€æ²»</button>
                <button class="story-btn" onclick="selectStory('creation')">å›½ç”Ÿã¿ç¥è©±</button>
                <button class="story-btn" onclick="selectStory('inaba')">å› å¹¡ã®ç™½å…</button>
            </div>
        </div>

        <!-- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ãƒ†ãƒ¼ã‚¸ -->
        <div class="animation-stage">
            <svg id="animationCanvas" viewBox="0 0 1000 500">
                <!-- èƒŒæ™¯è¦ç´  -->
                <defs>
                    <linearGradient id="skyGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#87CEEB;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#98D8E8;stop-opacity:1" />
                    </linearGradient>
                    <radialGradient id="sunGradient">
                        <stop offset="0%" style="stop-color:#FFD700;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#FFA500;stop-opacity:0.8" />
                    </radialGradient>
                </defs>
                
                <!-- èƒŒæ™¯ -->
                <rect width="1000" height="500" fill="url(#skyGradient)" />
                
                <!-- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³è¦ç´ ãŒã“ã“ã«è¿½åŠ ã•ã‚Œã‚‹ -->
            </svg>
        </div>

        <!-- ãƒ†ã‚­ã‚¹ãƒˆè¡¨ç¤º -->
        <div class="text-display">
            <h3 class="scene-title" id="sceneTitle">å¤©ç…§å¤§ç¥ã®å²©æˆ¸éš ã‚Œ</h3>
            <p class="scene-text" id="sceneText">
                å¤ªé™½ã®å¥³ç¥ãƒ»å¤©ç…§å¤§ç¥ãŒã€å¼Ÿã®é ˆä½ä¹‹ç”·å‘½ã®ä¹±æš´ãªæŒ¯ã‚‹èˆã„ã«æ€’ã‚Šã€å¤©ã®å²©æˆ¸ã«éš ã‚Œã¦ã—ã¾ã„ã¾ã—ãŸã€‚
                ä¸–ç•Œã¯æš—é—‡ã«åŒ…ã¾ã‚Œã€ç¥ã€…ã¯å›°ã‚Šæœã¦ã¾ã—ãŸ...
            </p>
        </div>

        <!-- ãƒ—ãƒ¬ã‚¤ãƒãƒƒã‚¯ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« -->
        <div class="playback-controls">
            <button class="control-btn" onclick="playAnimation()">
                <span>â–¶</span> å†ç”Ÿ
            </button>
            <button class="control-btn" onclick="pauseAnimation()">
                <span>â¸</span> ä¸€æ™‚åœæ­¢
            </button>
            <button class="control-btn" onclick="resetAnimation()">
                <span>â®</span> ãƒªã‚»ãƒƒãƒˆ
            </button>
            
            <div class="speed-control">
                <label>é€Ÿåº¦:</label>
                <input type="range" class="speed-slider" id="speedSlider" 
                       min="0.5" max="2" step="0.1" value="1">
                <span id="speedValue">1x</span>
            </div>
        </div>
    </div>

    <script>
        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹ç®¡ç†
        let currentStory = 'amaterasu';
        let animationFrame = null;
        let isPlaying = false;
        let animationSpeed = 1;
        let currentScene = 0;

        // SVGè¦ç´ ã®å–å¾—
        const svg = document.getElementById('animationCanvas');

        // ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ‡ãƒ¼ã‚¿
        const stories = {
            amaterasu: {
                title: 'å¤©ç…§å¤§ç¥ã®å²©æˆ¸éš ã‚Œ',
                scenes: [
                    {
                        title: 'ã‚·ãƒ¼ãƒ³1ï¼šé ˆä½ä¹‹ç”·ã®æš´æŒ™',
                        text: 'é ˆä½ä¹‹ç”·å‘½ãŒé«˜å¤©åŸã§ä¹±æš´ãªæŒ¯ã‚‹èˆã„ã‚’ã—ã¦ã€å¤©ç…§å¤§ç¥ã‚’æ€’ã‚‰ã›ã¾ã—ãŸã€‚',
                        duration: 3000
                    },
                    {
                        title: 'ã‚·ãƒ¼ãƒ³2ï¼šå²©æˆ¸ã«éš ã‚Œã‚‹',
                        text: 'å¤©ç…§å¤§ç¥ã¯å¤©ã®å²©æˆ¸ã«éš ã‚Œã€ä¸–ç•Œã¯æš—é—‡ã«åŒ…ã¾ã‚Œã¾ã—ãŸã€‚',
                        duration: 3000
                    },
                    {
                        title: 'ã‚·ãƒ¼ãƒ³3ï¼šç¥ã€…ã®ä½œæˆ¦',
                        text: 'å…«ç™¾ä¸‡ã®ç¥ã€…ãŒé›†ã¾ã‚Šã€å¤©ç…§å¤§ç¥ã‚’èª˜ã„å‡ºã™ä½œæˆ¦ã‚’ç«‹ã¦ã¾ã—ãŸã€‚',
                        duration: 3000
                    },
                    {
                        title: 'ã‚·ãƒ¼ãƒ³4ï¼šå¤©éˆ¿å¥³ã®èˆ',
                        text: 'å¤©éˆ¿å¥³å‘½ãŒè¸Šã‚Šã€ç¥ã€…ãŒå¤§ç¬‘ã„ã™ã‚‹ã¨ã€å¤©ç…§å¤§ç¥ã¯å²©æˆ¸ã‹ã‚‰é¡”ã‚’å‡ºã—ã¾ã—ãŸã€‚',
                        duration: 3000
                    }
                ]
            },
            yamata: {
                title: 'ãƒ¤ãƒã‚¿ãƒã‚ªãƒ­ãƒé€€æ²»',
                scenes: [
                    {
                        title: 'ã‚·ãƒ¼ãƒ³1ï¼šé ˆä½ä¹‹ç”·ã®æ—…',
                        text: 'é«˜å¤©åŸã‚’è¿½æ”¾ã•ã‚ŒãŸé ˆä½ä¹‹ç”·å‘½ã¯ã€å‡ºé›²ã®å›½ã¸ã¨ã‚„ã£ã¦ãã¾ã—ãŸã€‚',
                        duration: 3000
                    },
                    {
                        title: 'ã‚·ãƒ¼ãƒ³2ï¼šæ«›åç”°å§«ã¨ã®å‡ºä¼šã„',
                        text: 'æ³£ã„ã¦ã„ã‚‹è€å¤«å©¦ã¨ç¾ã—ã„å¨˜ãƒ»æ«›åç”°å§«ã«å‡ºä¼šã„ã¾ã—ãŸã€‚',
                        duration: 3000
                    },
                    {
                        title: 'ã‚·ãƒ¼ãƒ³3ï¼šå…«å²å¤§è›‡ã®è„…å¨',
                        text: '8ã¤ã®é ­ã¨å°¾ã‚’æŒã¤æã‚ã—ã„å¤§è›‡ãŒã€æ¯å¹´å¨˜ã‚’é£Ÿã¹ã«æ¥ã‚‹ã¨ã„ã†è©±ã‚’èãã¾ã—ãŸã€‚',
                        duration: 3000
                    },
                    {
                        title: 'ã‚·ãƒ¼ãƒ³4ï¼šå¤§è›‡é€€æ²»',
                        text: 'é ˆä½ä¹‹ç”·ã¯é…’ã§å¤§è›‡ã‚’é…”ã‚ã›ã€è¦‹äº‹ã«é€€æ²»ã—ã¾ã—ãŸã€‚',
                        duration: 3000
                    }
                ]
            }
        };

        // ç«æŸ´äººã®æç”»
        function drawStickFigure(x, y, id, color = '#000') {
            const group = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            group.setAttribute('id', id);
            
            // é ­
            const head = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
            head.setAttribute('cx', x);
            head.setAttribute('cy', y - 40);
            head.setAttribute('r', 15);
            head.setAttribute('fill', color);
            head.setAttribute('stroke', color);
            head.setAttribute('stroke-width', '2');
            
            // ä½“
            const body = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            body.setAttribute('x1', x);
            body.setAttribute('y1', y - 25);
            body.setAttribute('x2', x);
            body.setAttribute('y2', y + 20);
            body.setAttribute('stroke', color);
            body.setAttribute('stroke-width', '3');
            
            // å·¦è…•
            const leftArm = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            leftArm.setAttribute('x1', x);
            leftArm.setAttribute('y1', y - 10);
            leftArm.setAttribute('x2', x - 20);
            leftArm.setAttribute('y2', y);
            leftArm.setAttribute('stroke', color);
            leftArm.setAttribute('stroke-width', '3');
            
            // å³è…•
            const rightArm = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            rightArm.setAttribute('x1', x);
            rightArm.setAttribute('y1', y - 10);
            rightArm.setAttribute('x2', x + 20);
            rightArm.setAttribute('y2', y);
            rightArm.setAttribute('stroke', color);
            rightArm.setAttribute('stroke-width', '3');
            
            // å·¦è„š
            const leftLeg = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            leftLeg.setAttribute('x1', x);
            leftLeg.setAttribute('y1', y + 20);
            leftLeg.setAttribute('x2', x - 15);
            leftLeg.setAttribute('y2', y + 40);
            leftLeg.setAttribute('stroke', color);
            leftLeg.setAttribute('stroke-width', '3');
            
            // å³è„š
            const rightLeg = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            rightLeg.setAttribute('x1', x);
            rightLeg.setAttribute('y1', y + 20);
            rightLeg.setAttribute('x2', x + 15);
            rightLeg.setAttribute('y2', y + 40);
            rightLeg.setAttribute('stroke', color);
            rightLeg.setAttribute('stroke-width', '3');
            
            group.appendChild(head);
            group.appendChild(body);
            group.appendChild(leftArm);
            group.appendChild(rightArm);
            group.appendChild(leftLeg);
            group.appendChild(rightLeg);
            
            return group;
        }

        // å¤ªé™½ã®æç”»
        function drawSun(x, y, radius = 50) {
            const sun = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
            sun.setAttribute('id', 'sun');
            sun.setAttribute('cx', x);
            sun.setAttribute('cy', y);
            sun.setAttribute('r', radius);
            sun.setAttribute('fill', 'url(#sunGradient)');
            
            // å…‰ç·š
            const rays = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            rays.setAttribute('id', 'sunRays');
            
            for (let i = 0; i < 8; i++) {
                const angle = (i * Math.PI * 2) / 8;
                const ray = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                ray.setAttribute('x1', x + Math.cos(angle) * (radius + 5));
                ray.setAttribute('y1', y + Math.sin(angle) * (radius + 5));
                ray.setAttribute('x2', x + Math.cos(angle) * (radius + 20));
                ray.setAttribute('y2', y + Math.sin(angle) * (radius + 20));
                ray.setAttribute('stroke', '#FFD700');
                ray.setAttribute('stroke-width', '3');
                rays.appendChild(ray);
            }
            
            const group = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            group.appendChild(sun);
            group.appendChild(rays);
            
            return group;
        }

        // å²©æˆ¸ã®æç”»
        function drawCave() {
            const cave = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            cave.setAttribute('id', 'cave');
            cave.setAttribute('x', 700);
            cave.setAttribute('y', 200);
            cave.setAttribute('width', 150);
            cave.setAttribute('height', 200);
            cave.setAttribute('fill', '#8B7355');
            cave.setAttribute('stroke', '#654321');
            cave.setAttribute('stroke-width', '3');
            cave.setAttribute('rx', '10');
            
            return cave;
        }

        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆæœŸåŒ–
        function initAnimation() {
            // æ—¢å­˜ã®è¦ç´ ã‚’ã‚¯ãƒªã‚¢
            while (svg.lastChild && svg.lastChild.id !== 'skyGradient') {
                svg.removeChild(svg.lastChild);
            }
            
            // èƒŒæ™¯ã‚’å†æç”»
            const bg = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            bg.setAttribute('width', '1000');
            bg.setAttribute('height', '500');
            bg.setAttribute('fill', 'url(#skyGradient)');
            svg.appendChild(bg);
            
            if (currentStory === 'amaterasu') {
                initAmaterasuAnimation();
            } else if (currentStory === 'yamata') {
                initYamataAnimation();
            }
        }

        // å¤©ç…§å¤§ç¥ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆæœŸåŒ–
        function initAmaterasuAnimation() {
            // å¤ªé™½ï¼ˆå¤©ç…§å¤§ç¥ï¼‰
            svg.appendChild(drawSun(200, 100));
            
            // é ˆä½ä¹‹ç”·ï¼ˆç«æŸ´äººï¼‰
            svg.appendChild(drawStickFigure(300, 300, 'susanoo', '#4169E1'));
            
            // å²©æˆ¸
            svg.appendChild(drawCave());
            
            // ä»–ã®ç¥ã€…
            for (let i = 0; i < 3; i++) {
                svg.appendChild(drawStickFigure(100 + i * 100, 350, `god${i}`, '#FF69B4'));
            }
        }

        // ãƒ¤ãƒã‚¿ãƒã‚ªãƒ­ãƒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆæœŸåŒ–
        function initYamataAnimation() {
            // é ˆä½ä¹‹ç”·
            svg.appendChild(drawStickFigure(100, 300, 'susanoo', '#4169E1'));
            
            // å¤§è›‡ã®ç°¡æ˜“è¡¨ç¾
            const snake = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            snake.setAttribute('id', 'yamata');
            snake.setAttribute('d', 'M 700 300 Q 750 250 800 300 Q 850 350 900 300');
            snake.setAttribute('stroke', '#8B0000');
            snake.setAttribute('stroke-width', '20');
            snake.setAttribute('fill', 'none');
            svg.appendChild(snake);
        }

        // ã‚¹ãƒˆãƒ¼ãƒªãƒ¼é¸æŠ
        function selectStory(storyId) {
            currentStory = storyId;
            currentScene = 0;
            
            // ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹æ›´æ–°
            document.querySelectorAll('.story-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // ã‚¹ãƒˆãƒ¼ãƒªãƒ¼æƒ…å ±æ›´æ–°
            const story = stories[storyId];
            if (story) {
                document.getElementById('sceneTitle').textContent = story.scenes[0].title;
                document.getElementById('sceneText').textContent = story.scenes[0].text;
            }
            
            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒªã‚»ãƒƒãƒˆ
            resetAnimation();
        }

        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å†ç”Ÿ
        function playAnimation() {
            if (!isPlaying) {
                isPlaying = true;
                animateScene();
            }
        }

        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä¸€æ™‚åœæ­¢
        function pauseAnimation() {
            isPlaying = false;
            if (animationFrame) {
                cancelAnimationFrame(animationFrame);
            }
        }

        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒªã‚»ãƒƒãƒˆ
        function resetAnimation() {
            pauseAnimation();
            currentScene = 0;
            initAnimation();
        }

        // ã‚·ãƒ¼ãƒ³ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        function animateScene() {
            if (!isPlaying) return;
            
            const story = stories[currentStory];
            if (!story || currentScene >= story.scenes.length) {
                isPlaying = false;
                return;
            }
            
            const scene = story.scenes[currentScene];
            document.getElementById('sceneTitle').textContent = scene.title;
            document.getElementById('sceneText').textContent = scene.text;
            
            // ã‚·ãƒ¼ãƒ³å›ºæœ‰ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
            if (currentStory === 'amaterasu') {
                animateAmaterasuScene(currentScene);
            }
            
            // æ¬¡ã®ã‚·ãƒ¼ãƒ³ã¸
            setTimeout(() => {
                currentScene++;
                if (currentScene < story.scenes.length) {
                    animateScene();
                } else {
                    isPlaying = false;
                }
            }, scene.duration / animationSpeed);
        }

        // å¤©ç…§å¤§ç¥ã‚·ãƒ¼ãƒ³ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        function animateAmaterasuScene(sceneIndex) {
            const sun = document.getElementById('sun');
            const susanoo = document.getElementById('susanoo');
            
            switch(sceneIndex) {
                case 0: // é ˆä½ä¹‹ç”·ã®æš´æŒ™
                    // é ˆä½ä¹‹ç”·ãŒå‹•ãå›ã‚‹
                    susanoo.style.transition = 'transform 2s';
                    susanoo.style.transform = 'translateX(200px)';
                    break;
                    
                case 1: // å²©æˆ¸ã«éš ã‚Œã‚‹
                    // å¤ªé™½ãŒå²©æˆ¸ã«ç§»å‹•
                    sun.style.transition = 'transform 2s';
                    sun.style.transform = 'translate(500px, 100px)';
                    // èƒŒæ™¯ã‚’æš—ãã™ã‚‹
                    svg.style.filter = 'brightness(0.5)';
                    break;
                    
                case 2: // ç¥ã€…ã®ä½œæˆ¦
                    // ç¥ã€…ãŒé›†ã¾ã‚‹
                    for (let i = 0; i < 3; i++) {
                        const god = document.getElementById(`god${i}`);
                        if (god) {
                            god.style.transition = 'transform 2s';
                            god.style.transform = 'translateX(300px)';
                        }
                    }
                    break;
                    
                case 3: // å¤©éˆ¿å¥³ã®èˆ
                    // è¸Šã‚Šã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
                    const god0 = document.getElementById('god0');
                    if (god0) {
                        god0.style.animation = 'dance 2s ease-in-out';
                    }
                    // æ˜ã‚‹ã•ã‚’æˆ»ã™
                    setTimeout(() => {
                        svg.style.filter = 'brightness(1)';
                    }, 1500);
                    break;
            }
        }

        // ã‚¹ãƒ”ãƒ¼ãƒ‰èª¿æ•´
        document.getElementById('speedSlider').addEventListener('input', (e) => {
            animationSpeed = parseFloat(e.target.value);
            document.getElementById('speedValue').textContent = animationSpeed + 'x';
        });

        // æ¡œã®èŠ±ã³ã‚‰ã‚’ç”Ÿæˆ
        function createSakuraPetal() {
            const petal = document.createElement('div');
            petal.className = 'sakura-petal';
            petal.textContent = 'ğŸŒ¸';
            petal.style.left = Math.random() * window.innerWidth + 'px';
            petal.style.animationDuration = (5 + Math.random() * 5) + 's';
            petal.style.fontSize = (15 + Math.random() * 10) + 'px';
            document.body.appendChild(petal);
            
            setTimeout(() => petal.remove(), 10000);
        }

        // å®šæœŸçš„ã«æ¡œã‚’ç”Ÿæˆ
        setInterval(createSakuraPetal, 2000);

        // è¸Šã‚Šã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾©
        const style = document.createElement('style');
        style.textContent = `
            @keyframes dance {
                0%, 100% { transform: translateX(300px) translateY(0); }
                25% { transform: translateX(320px) translateY(-20px); }
                50% { transform: translateX(300px) translateY(0); }
                75% { transform: translateX(280px) translateY(-20px); }
            }
        `;
        document.head.appendChild(style);

        // åˆæœŸåŒ–
        initAnimation();
    </script>
</body>
</html>