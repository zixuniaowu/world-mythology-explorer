<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World Mythology Explorer - Interactive Map</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            min-height: 100vh;
            overflow-x: hidden;
            color: #fff;
        }

        /* Header Styles */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            padding: 20px 40px;
            background: rgba(15, 12, 41, 0.9);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.3);
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            cursor: pointer;
        }

        .nav-controls {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .search-box {
            position: relative;
        }

        .search-input {
            padding: 10px 40px 10px 15px;
            border-radius: 25px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            width: 250px;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255, 255, 255, 0.15);
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.5);
        }

        .language-selector {
            display: flex;
            gap: 10px;
        }

        .lang-btn {
            padding: 8px 16px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: transparent;
            color: #fff;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .lang-btn:hover, .lang-btn.active {
            background: rgba(102, 126, 234, 0.3);
            border-color: #667eea;
        }

        /* Main Container */
        .main-container {
            margin-top: 100px;
            padding: 40px;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
        }

        .page-title {
            text-align: center;
            margin-bottom: 40px;
        }

        .page-title h1 {
            font-size: 3em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #f093fb 0%, #f5576c 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .page-subtitle {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.2em;
        }

        /* Map Container */
        .map-container {
            position: relative;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        .map-wrapper {
            position: relative;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }

        #worldMapCanvas {
            width: 100%;
            height: auto;
            cursor: crosshair;
            border-radius: 10px;
            box-shadow: 0 0 50px rgba(102, 126, 234, 0.3), 
                        inset 0 0 30px rgba(102, 126, 234, 0.1);
        }

        /* Mythology Markers */
        .mythology-marker {
            position: absolute;
            width: 40px;
            height: 40px;
            transform: translate(-50%, -50%);
            cursor: pointer;
            z-index: 10;
            transition: all 0.3s ease;
        }

        .mythology-marker:hover {
            transform: translate(-50%, -50%) scale(1.2);
        }

        .marker-inner {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .marker-glow {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.8) 0%, transparent 70%);
            animation: pulse 2s infinite;
            filter: blur(2px);
        }

        .marker-pin {
            position: absolute;
            width: 30px;
            height: 30px;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            background: radial-gradient(circle, #fff 30%, transparent 70%);
            border-radius: 50%;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
            border: 2px solid rgba(255, 255, 255, 0.6);
        }

        .mythology-marker.active .marker-pin {
            transform: translate(-50%, -50%) scale(1.3);
            box-shadow: 0 0 30px rgba(255, 255, 255, 1);
        }

        .marker-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .mythology-marker:hover .marker-label {
            opacity: 1;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.5);
                opacity: 0.5;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* Connection Lines */
        .connection-line {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transform-origin: left center;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .connection-line.show {
            opacity: 1;
            animation: flow 3s linear infinite;
        }

        @keyframes flow {
            0% {
                background-position: -100% 0;
            }
            100% {
                background-position: 200% 0;
            }
        }

        /* Enhanced marker animations */
        .mythology-marker {
            animation: float-marker 3s ease-in-out infinite;
            animation-delay: calc(var(--marker-index) * 0.2s);
        }

        @keyframes float-marker {
            0%, 100% {
                transform: translate(-50%, -50%) translateY(0);
            }
            50% {
                transform: translate(-50%, -50%) translateY(-5px);
            }
        }

        /* Mythology Cards */
        .mythology-card {
            position: absolute;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.9) 100%);
            border-radius: 15px;
            padding: 25px;
            width: 350px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            opacity: 0;
            transform: translateY(20px) scale(0.9);
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 100;
            color: #333;
            display: none;
        }

        .mythology-card.show {
            opacity: 1;
            transform: translateY(0) scale(1);
            display: block;
        }

        .mythology-card h3 {
            font-size: 24px;
            margin-bottom: 10px;
            color: #333;
        }

        .mythology-origin {
            color: #666;
            font-size: 14px;
            margin-bottom: 15px;
        }

        .mythology-description {
            color: #555;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .mythology-features {
            margin-bottom: 20px;
        }

        .feature-tag {
            display: inline-block;
            padding: 5px 12px;
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            border-radius: 15px;
            font-size: 12px;
            margin-right: 8px;
            margin-bottom: 8px;
        }

        .explore-btn {
            display: block;
            width: 100%;
            padding: 12px;
            background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .explore-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .close-card {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.1);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .close-card:hover {
            background: rgba(0, 0, 0, 0.2);
        }

        /* Map overlay effect */
        .map-wrapper::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(ellipse at center, transparent 0%, rgba(15, 12, 41, 0.2) 100%);
            pointer-events: none;
            z-index: 5;
        }

        /* Floating Particles */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.3) 0%, transparent 70%);
            border-radius: 50%;
            animation: float 20s infinite;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0) translateX(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) translateX(100px);
                opacity: 0;
            }
        }

        /* Legend */
        .legend {
            margin-top: 30px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        /* About Section */
        .about-section {
            margin-top: 60px;
            text-align: center;
            color: rgba(255, 255, 255, 0.7);
        }

        .about-section h2 {
            font-size: 2em;
            margin-bottom: 20px;
            color: #fff;
        }

        .about-content {
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.8;
        }

        .links-section {
            margin-top: 40px;
            display: flex;
            justify-content: center;
            gap: 30px;
        }

        .link-btn {
            padding: 12px 30px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: #fff;
            text-decoration: none;
            border-radius: 25px;
            transition: all 0.3s ease;
        }

        .link-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: #667eea;
            transform: translateY(-2px);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header {
                padding: 15px 20px;
            }

            .nav-controls {
                flex-direction: column;
                gap: 10px;
            }

            .search-input {
                width: 200px;
            }

            .main-container {
                padding: 20px;
                margin-top: 120px;
            }

            .page-title h1 {
                font-size: 2em;
            }

            .mythology-card {
                width: 300px;
            }

            .links-section {
                flex-direction: column;
                align-items: center;
            }
        }

        /* Loading Animation */
        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            color: #667eea;
        }

        /* Tooltip */
        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: #fff;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 14px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }

        .tooltip.show {
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- Floating Particles -->
    <div class="particles" id="particles"></div>

    <!-- Header -->
    <header class="header">
        <div class="logo" onclick="location.reload()">World Mythology Explorer</div>
        <div class="nav-controls">
            <div class="search-box">
                <input type="text" class="search-input" id="searchInput" placeholder="Á•ûË©±„ÇíÊ§úÁ¥¢...">
                <span class="search-icon">üîç</span>
            </div>
            <div class="language-selector">
                <button class="lang-btn" data-lang="en">English</button>
                <button class="lang-btn" data-lang="zh">‰∏≠Êñá</button>
                <button class="lang-btn active" data-lang="ja">Êó•Êú¨Ë™û</button>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <div class="page-title">
            <h1 id="mainTitle">‰∏ñÁïåÁ•ûË©±„ÅÆÊóÖ</h1>
            <p class="page-subtitle" id="subtitle">Âú∞Âüü„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Á•ûË©±„ÅÆÂÆùÁâ©„ÇíÊé¢Á¥¢</p>
        </div>

        <!-- Map Container -->
        <div class="map-container">
            <div class="map-wrapper">
                <canvas id="worldMapCanvas"></canvas>
                <div id="mythologyMarkers"></div>
                <div id="connectionLines"></div>
            </div>

            <!-- Mythology Cards (dynamically positioned) -->
            <div id="mythologyCards"></div>

            <!-- Tooltip -->
            <div class="tooltip" id="tooltip"></div>
        </div>

        <!-- Legend -->
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: #ff6b6b;"></div>
                <span>East Asian Mythology</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #4ecdc4;"></div>
                <span>South Asian Mythology</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #f7b731;"></div>
                <span>Middle Eastern Mythology</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #5f27cd;"></div>
                <span>European Mythology</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #ee5a6f;"></div>
                <span>African Mythology</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #00d2d3;"></div>
                <span>American Mythology</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #22a6b3;"></div>
                <span>Oceanic Mythology</span>
            </div>
        </div>

        <!-- About Section -->
        <div class="about-section">
            <h2>‰∏ñÁïåÁ•ûË©±„Ç®„ÇØ„Çπ„Éó„É≠„Éº„É©„Éº„Å´„Å§„ÅÑ„Å¶</h2>
            <div class="about-content">
                <p>‰∫∫Èñì„ÅÆÊÉ≥ÂÉèÂäõ„ÅÆË±ä„Åã„Å™„Çø„Éö„Çπ„Éà„É™„Éº„ÇíÊóÖ„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ„É°„ÇΩ„Éù„Çø„Éü„Ç¢„ÅÆÂè§‰ª£„ÅÆÁâ©Ë™û„Åã„ÇâÂ§™Âπ≥Ê¥ãË´∏Â≥∂„ÅÆÈÆÆ„ÇÑ„Åã„Å™Áâ©Ë™û„Åæ„Åß„ÄÅ„Åï„Åæ„Åñ„Åæ„Å™ÊñáÂåñ„ÅåÁ•ûË©±„ÇíÈÄö„Åò„Å¶Â≠òÂú®„ÅÆÁ•ûÁßò„Çí„Å©„ÅÆ„Çà„ÅÜ„Å´Ë™¨Êòé„Åó„Å¶„Åç„Åü„Åã„ÇíÊé¢„Çä„Åæ„Åô„ÄÇ</p>
                <p>ÂêÑÁ•ûË©±„ÅØÂçò„Å™„ÇãÁâ©Ë™û„Åß„ÅØ„Å™„Åè„ÄÅÊñáÊòé„ÅÆÈ≠Ç„ÇíË°®„Åó„Å¶„ÅÑ„Åæ„Åô - ÂΩº„Çâ„ÅÆ‰æ°ÂÄ§Ë¶≥„ÄÅÊÅê„Çå„ÄÅÂ∏åÊúõ„ÄÅ„Åù„Åó„Å¶ÂÆáÂÆô„Å∏„ÅÆÁêÜËß£„ÄÇ‰ªªÊÑè„ÅÆÂú∞Âüü„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„ÄÅ„Åù„ÅÆÁ•ûË©±„ÅÆÈÅ∫Áî£„ÇíÁô∫Ë¶ã„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
            </div>
            <div class="links-section">
                <a href="ai-text-to-animation.html" class="link-btn">AI„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„ÉÑ„Éº„É´</a>
                <a href="text-to-animation.html" class="link-btn">„Ç∑„É≥„Éó„É´„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥</a>
                <a href="#" class="link-btn">„Ç≥„Éü„É•„Éã„ÉÜ„Ç£„Éï„Ç©„Éº„É©„É†</a>
            </div>
        </div>
    </div>

    <script>
        // Mythology locations with real world coordinates (normalized 0-1)
        const mythologyLocations = {
            china: { x: 0.75, y: 0.35, name: "China", region: "Â±±Êµ∑Áªè" },
            japan: { x: 0.85, y: 0.37, name: "Japan", region: "Êó•Êú¨" },
            india: { x: 0.65, y: 0.45, name: "India", region: "‡§≠‡§æ‡§∞‡§§" },
            greece: { x: 0.52, y: 0.38, name: "Greece", region: "ŒïŒªŒªŒ¨Œ¥Œ±" },
            egypt: { x: 0.53, y: 0.47, name: "Egypt", region: "ŸÖÿµÿ±" },
            norse: { x: 0.50, y: 0.25, name: "Scandinavia", region: "Norge" },
            celtic: { x: 0.47, y: 0.30, name: "Ireland", region: "√âire" },
            mesopotamia: { x: 0.57, y: 0.42, name: "Mesopotamia", region: "Iraq" },
            aztecMaya: { x: 0.25, y: 0.45, name: "Mexico", region: "M√©xico" },
            nativeAmerican: { x: 0.20, y: 0.35, name: "North America", region: "Turtle Island" },
            westAfrica: { x: 0.49, y: 0.55, name: "West Africa", region: "Nigeria/Ghana" },
            aboriginal: { x: 0.80, y: 0.75, name: "Australia", region: "Dreamtime" },
            polynesian: { x: 0.15, y: 0.60, name: "Pacific", region: "Polynesia" }
        };

        // Mythology Data
        const mythologyData = {
            china: {
                title: "Chinese Mythology",
                titleZh: "‰∏≠ÂõΩÁ•ûËØù",
                titleJa: "‰∏≠ÂõΩÁ•ûË©±",
                origin: "Ancient China",
                originJa: "Âè§‰ª£‰∏≠ÂõΩ",
                description: "A rich tapestry of legends including the Classic of Mountains and Seas (Â±±Êµ∑Áªè), Investiture of the Gods (Â∞ÅÁ•ûÊºî‰πâ), and Strange Tales from a Chinese Studio (ËÅäÊñãÂøóÂºÇ).",
                descriptionJa: "Â±±Êµ∑Áµå„ÄÅÂ∞ÅÁ•ûÊºîÁæ©„ÄÅËÅäÊñéÂøóÁï∞„Å™„Å©„ÅÆË±ä„Åã„Å™‰ºùË™¨„ÅÆÁπîÁâ©„ÄÇÂè§‰ª£‰∏≠ÂõΩ„ÅÆÁ•ûË©±‰ΩìÁ≥ª„ÅØ„ÄÅÂ§©Âú∞ÂâµÈÄ†„Åã„ÇâÁ•û„ÄÖ„Å®Â¶ñÊÄ™„ÅÆÁâ©Ë™û„Åæ„ÅßÂπÖÂ∫É„ÅèÂ±ïÈñã„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ",
                features: ["Dragons", "Immortals", "Journey to the West", "Jade Emperor", "Fox Spirits"],
                featuresJa: ["Èæç", "‰ªô‰∫∫", "Ë•øÈÅäË®ò", "ÁéâÁöáÂ§ßÂ∏ù", "ÁãêÁã∏Á≤æ"],
                color: "#ff6b6b"
            },
            japan: {
                title: "Japanese Mythology",
                titleZh: "Êó•Êú¨Á•ûËØù",
                titleJa: "Êó•Êú¨Á•ûË©±",
                origin: "Ancient Japan",
                originZh: "Âè§‰ª£Êó•Êú¨",
                originJa: "Âè§‰ª£Êó•Êú¨",
                description: "Ancient chronicles like Kojiki (Âè§‰∫ãË®ò) and Nihon Shoki (Êó•Êú¨Êõ∏Á¥Ä), plus a rich tradition of yokai (Â¶ñÊÄ™) folklore.",
                descriptionZh: "ÂåÖÊã¨Âè§‰∫ãËÆ∞„ÄÅÊó•Êú¨‰π¶Á∫™Á≠âÂè§‰ª£ÁºñÂπ¥Âè≤Ôºå‰ª•Âèä‰∏∞ÂØåÁöÑÂ¶ñÊÄ™Ê∞ë‰øó‰º†Áªü„ÄÇ",
                descriptionJa: "Âè§‰∫ãË®ò„ÇÑÊó•Êú¨Êõ∏Á¥Ä„Å™„Å©„ÅÆÂè§‰ª£„ÅÆË®òÈå≤„ÄÅ„Åù„Åó„Å¶Ë±ä„Åã„Å™Â¶ñÊÄ™„ÅÆÊ∞ë‰øó‰ºùÁµ±„ÄÇ",
                features: ["Kami", "Yokai", "Amaterasu", "Susanoo", "Kitsune"],
                featuresJa: ["Á•û", "Â¶ñÊÄ™", "Â§©ÁÖßÂ§ßÁ•û", "È†à‰Ωê‰πãÁî∑", "Áãê"],
                featuresZh: ["Á•ûÁÅµ", "Â¶ñÊÄ™", "Â§©ÁÖßÂ§ßÁ•û", "È°ª‰Ωê‰πãÁî∑", "ÁãêÁã∏"],
                color: "#ff9999"
            },
            india: {
                title: "Indian Mythology",
                titleZh: "Âç∞Â∫¶Á•ûËØù",
                titleJa: "„Ç§„É≥„ÉâÁ•ûË©±",
                origin: "Ancient India",
                originJa: "Âè§‰ª£„Ç§„É≥„Éâ",
                description: "Epic tales from the Mahabharata, Ramayana, and ancient Vedic texts that form the foundation of Hindu philosophy.",
                descriptionJa: "„Éû„Éè„Éº„Éê„Éº„É©„Çø„ÄÅ„É©„Éº„Éû„Éº„É§„Éä„ÄÅ„Åù„Åó„Å¶Âè§‰ª£„É¥„Çß„Éº„ÉÄ„ÅÆÁµåÂÖ∏„Åã„Çâ„ÅÆÂ£ÆÂ§ß„Å™Áâ©Ë™û„ÄÇ„Éí„É≥„Éâ„Ç•„ÉºÂì≤Â≠¶„ÅÆÂü∫Á§é„ÇíÂΩ¢Êàê„Åô„ÇãÁ•ûË©±‰ΩìÁ≥ª„Åß„Åô„ÄÇ",
                features: ["Vishnu", "Shiva", "Krishna", "Rama", "Vedas"],
                featuresJa: ["„É¥„Ç£„Ç∑„É•„Éå", "„Ç∑„É¥„Ç°", "„ÇØ„É™„Ç∑„É•„Éä", "„É©„Éº„Éû", "„É¥„Çß„Éº„ÉÄ"],
                color: "#4ecdc4"
            },
            mesopotamia: {
                title: "Mesopotamian Mythology",
                titleZh: "ÁæéÁ¥¢‰∏çËææÁ±≥‰∫öÁ•ûËØù",
                titleJa: "„É°„ÇΩ„Éù„Çø„Éü„Ç¢Á•ûË©±",
                origin: "Ancient Mesopotamia",
                originJa: "Âè§‰ª£„É°„ÇΩ„Éù„Çø„Éü„Ç¢",
                description: "The world's oldest recorded myths, including the Epic of Gilgamesh and tales from ancient Babylon and Sumeria.",
                descriptionJa: "„ÇÆ„É´„Ç¨„É°„Ç∑„É•Âèô‰∫ãË©©„ÇíÂê´„ÇÄ‰∏ñÁïåÊúÄÂè§„ÅÆË®òÈå≤„Åï„Çå„ÅüÁ•ûË©±„ÄÇÂè§‰ª£„Éê„Éì„É≠„É≥„Å®„Ç∑„É•„É°„Éº„É´„ÅÆÁâ©Ë™û„ÅåÊñáÊòé„ÅÆÈªéÊòéÊúü„ÇíÁâ©Ë™û„Çä„Åæ„Åô„ÄÇ",
                features: ["Gilgamesh", "Enkidu", "Tiamat", "Marduk", "Ishtar"],
                featuresJa: ["„ÇÆ„É´„Ç¨„É°„Ç∑„É•", "„Ç®„É≥„Ç≠„Éâ„Ç•", "„ÉÜ„Ç£„Ç¢„Éû„Éà", "„Éû„É´„Éâ„Ç•„ÇØ", "„Ç§„Ç∑„É•„Çø„É´"],
                color: "#f7b731"
            },
            greece: {
                title: "Greek Mythology",
                titleZh: "Â∏åËÖäÁ•ûËØù",
                titleJa: "„ÇÆ„É™„Ç∑„É£Á•ûË©±",
                origin: "Ancient Greece",
                originJa: "Âè§‰ª£„ÇÆ„É™„Ç∑„É£",
                description: "The pantheon of Olympian gods and heroes whose stories have influenced Western culture for millennia.",
                descriptionJa: "„Ç™„É™„É≥„Éù„Çπ„ÅÆÁ•û„ÄÖ„Å®Ëã±ÈõÑ„Åü„Å°„ÅÆÁâ©Ë™û„ÄÇË•øÊ¥ãÊñáÂåñ„Å´Êï∞ÂçÉÂπ¥„Å´„Çè„Åü„Å£„Å¶ÂΩ±Èüø„Çí‰∏é„ÅàÁ∂ö„Åë„Å¶„ÅÑ„ÇãÁ•ûË©±‰ΩìÁ≥ª„Åß„Åô„ÄÇ",
                features: ["Zeus", "Athena", "Odysseus", "Hercules", "Olympus"],
                featuresJa: ["„Çº„Ç¶„Çπ", "„Ç¢„ÉÜ„Éä", "„Ç™„Éá„É•„ÉÉ„Çª„Ç¶„Çπ", "„Éò„É©„ÇØ„É¨„Çπ", "„Ç™„É™„É≥„Éù„Çπ"],
                color: "#5f27cd"
            },
            norse: {
                title: "Norse Mythology",
                titleZh: "ÂåóÊ¨ßÁ•ûËØù",
                titleJa: "ÂåóÊ¨ßÁ•ûË©±",
                origin: "Ancient Scandinavia",
                originJa: "Âè§‰ª£„Çπ„Ç´„É≥„Ç∏„Éä„Éì„Ç¢",
                description: "Tales of gods, giants, and the cosmic tree Yggdrasil from the Viking Age, preserved in the Eddas.",
                descriptionJa: "„Ç®„ÉÉ„ÉÄ„Å´‰øùÂ≠ò„Åï„Çå„Åü„É¥„Ç°„Ç§„Ç≠„É≥„Ç∞ÊôÇ‰ª£„ÅÆÁ•û„ÄÖ„ÄÅÂ∑®‰∫∫„ÄÅ‰∏ñÁïåÊ®π„É¶„Ç∞„Éâ„É©„Ç∑„É´„ÅÆÁâ©Ë™û„ÄÇÂåóÊ¨ß„ÅÆÂé≥„Åó„ÅÑËá™ÁÑ∂„ÅåÁîü„Çì„Å†Â£ÆÂ§ß„Å™Á•ûË©±„Åß„Åô„ÄÇ",
                features: ["Odin", "Thor", "Loki", "Ragnarok", "Valhalla"],
                featuresJa: ["„Ç™„Éº„Éá„Ç£„É≥", "„Éà„Éº„É´", "„É≠„Ç≠", "„É©„Ç∞„Éä„É≠„ÇØ", "„É¥„Ç°„É´„Éè„É©"],
                color: "#7f39fb"
            },
            celtic: {
                title: "Celtic Mythology",
                titleZh: "ÂáØÂ∞îÁâπÁ•ûËØù",
                titleJa: "„Ç±„É´„ÉàÁ•ûË©±",
                origin: "Ancient Celtic Lands",
                originJa: "Âè§‰ª£„Ç±„É´„ÉàÂú∞Âüü",
                description: "Mystical tales from Ireland, Wales, and Scotland featuring otherworldly beings and heroic quests.",
                descriptionJa: "„Ç¢„Ç§„É´„É©„É≥„Éâ„ÄÅ„Ç¶„Çß„Éº„É´„Ç∫„ÄÅ„Çπ„Ç≥„ÉÉ„Éà„É©„É≥„Éâ„Åã„Çâ‰ºù„Çè„ÇãÁ•ûÁßòÁöÑ„Å™Áâ©Ë™û„ÄÇÁï∞Áïå„ÅÆÂ≠òÂú®„Å®Ëã±ÈõÑ„ÅÆÂÜíÈô∫„ÅåÁπî„Çä„Å™„ÅôÂπªÊÉ≥ÁöÑ„Å™‰∏ñÁïå„Åß„Åô„ÄÇ",
                features: ["Tuatha D√© Danann", "C√∫ Chulainn", "Morrigan", "Druids", "Sidhe"],
                featuresJa: ["„Éà„Ç•„Ç¢„Éè„Éª„Éá„Éª„ÉÄ„Éä„Éº„É≥", "„ÇØ„Éº„Éª„Éï„Éº„É™„É≥", "„É¢„É™„Ç¨„É≥", "„Éâ„É´„Ç§„Éâ", "„Ç∑„Éº"],
                color: "#9c59d1"
            },
            egypt: {
                title: "Egyptian Mythology",
                titleZh: "ÂüÉÂèäÁ•ûËØù",
                titleJa: "„Ç®„Ç∏„Éó„ÉàÁ•ûË©±",
                origin: "Ancient Egypt",
                originJa: "Âè§‰ª£„Ç®„Ç∏„Éó„Éà",
                description: "Stories of gods who controlled the Nile, the afterlife, and the cosmic order, preserved in hieroglyphs and papyri.",
                descriptionJa: "„Éä„Ç§„É´Â∑ù„ÄÅÊù•‰∏ñ„ÄÅÂÆáÂÆô„ÅÆÁß©Â∫è„ÇíÂè∏„ÇãÁ•û„ÄÖ„ÅÆÁâ©Ë™û„ÄÇ„Éí„Ç®„É≠„Ç∞„É™„Éï„Å®„Éë„Éî„É´„Çπ„Å´‰øùÂ≠ò„Åï„Çå„ÅüÊ∞∏ÈÅ†„ÅÆÁîüÂëΩ„Å∏„ÅÆÊé¢Ê±Ç„Åß„Åô„ÄÇ",
                features: ["Ra", "Osiris", "Isis", "Anubis", "Book of the Dead"],
                featuresJa: ["„É©„Éº", "„Ç™„Ç∑„É™„Çπ", "„Ç§„Ç∑„Çπ", "„Ç¢„Éå„Éì„Çπ", "Ê≠ªËÄÖ„ÅÆÊõ∏"],
                color: "#ee5a6f"
            },
            westAfrica: {
                title: "West African Mythology",
                titleZh: "Ë•øÈùûÁ•ûËØù",
                titleJa: "Ë•ø„Ç¢„Éï„É™„Ç´Á•ûË©±",
                origin: "West Africa",
                originJa: "Ë•ø„Ç¢„Éï„É™„Ç´",
                description: "Oral traditions including the trickster Anansi and creation myths from various West African cultures.",
                descriptionJa: "„Ç¢„Éä„É≥„Ç∑„ÇíÂê´„ÇÄÂè£Êâø‰ºùÁµ±„ÄÇ„É®„É´„ÉêÊóè„Çí„ÅØ„Åò„ÇÅ„Å®„Åô„ÇãÊßò„ÄÖ„Å™Ë•ø„Ç¢„Éï„É™„Ç´ÊñáÂåñ„ÅÆÂâµÈÄ†Á•ûË©±„ÅåË±ä„Åã„Å™Á≤æÁ•û‰∏ñÁïå„ÇíÁâ©Ë™û„Çä„Åæ„Åô„ÄÇ",
                features: ["Anansi", "Yoruba Orishas", "Trickster Tales", "Creation Stories", "Ancestral Spirits"],
                featuresJa: ["„Ç¢„Éä„É≥„Ç∑", "„É®„É´„Éê„ÅÆ„Ç™„É™„Ç∑„É£", "„Éà„É™„ÉÉ„ÇØ„Çπ„Çø„ÉºÁâ©Ë™û", "Ââµ‰∏ñÁ•ûË©±", "Á•ñÂÖà„ÅÆÈúä"],
                color: "#ff7979"
            },
            aztecMaya: {
                title: "Aztec & Maya Mythology",
                titleZh: "ÈòøÂÖπÁâπÂÖã‰∏éÁéõÈõÖÁ•ûËØù",
                titleJa: "„Ç¢„Çπ„ÉÜ„Ç´„Éª„Éû„É§Á•ûË©±",
                origin: "Mesoamerica",
                originJa: "„É°„ÇΩ„Ç¢„É°„É™„Ç´",
                description: "Complex cosmologies from the Aztec and Maya civilizations, featuring feathered serpents and jaguar gods.",
                descriptionJa: "„Ç¢„Çπ„ÉÜ„Ç´„Å®„Éû„É§ÊñáÊòé„ÅÆË§áÈõë„Å™ÂÆáÂÆôË¶≥„ÄÇÁæΩÊØõ„ÅÆËõá„ÇÑ„Ç∏„É£„Ç¨„Éº„ÅÆÁ•û„ÄÖ„ÅåÁπî„Çä„Å™„Åô„ÄÅÂ§©ÊñáÂ≠¶„Å®Á≤æÁ•û‰∏ñÁïå„ÅåËûçÂêà„Åó„ÅüÁ•ûË©±‰ΩìÁ≥ª„Åß„Åô„ÄÇ",
                features: ["Quetzalcoatl", "Kukulkan", "Popol Vuh", "Tezcatlipoca", "Xibalba"],
                featuresJa: ["„Ç±„ÉÑ„Ç°„É´„Ç≥„Ç¢„Éà„É´", "„ÇØ„ÇØ„É´„Ç´„É≥", "„Éù„Éù„É´„Éª„É¥„Éº", "„ÉÜ„Çπ„Ç´„Éà„É™„Éù„Ç´", "„Ç∑„Éê„É´„Éê"],
                color: "#00d2d3"
            },
            nativeAmerican: {
                title: "Native American Mythology",
                titleZh: "ÂåóÁæéÂéü‰ΩèÊ∞ëÁ•ûËØù",
                titleJa: "„Éç„Ç§„ÉÜ„Ç£„Éñ„Ç¢„É°„É™„Ç´„É≥Á•ûË©±",
                origin: "North America",
                originJa: "Âåó„Ç¢„É°„É™„Ç´",
                description: "Diverse traditions from hundreds of tribes, featuring creation stories, animal spirits, and sacred landscapes.",
                descriptionJa: "Êï∞Áôæ„ÅÆÈÉ®Êóè„Åã„Çâ‰ºù„Çè„ÇãÂ§öÊßò„Å™‰ºùÁµ±„ÄÇÂâµ‰∏ñÁâ©Ë™û„ÄÅÂãïÁâ©„ÅÆÈúä„ÄÅËÅñ„Å™„ÇãÂ§ßÂú∞„ÅåÁ¥°„Åê„ÄÅËá™ÁÑ∂„Å®„ÅÆÊ∑±„ÅÑÁµÜ„ÇíË°®„ÅôÁ•ûË©±„Åß„Åô„ÄÇ",
                features: ["Coyote", "Thunderbird", "Great Spirit", "Vision Quests", "Sacred Animals"],
                featuresJa: ["„Ç≥„É®„Éº„ÉÜ", "„Çµ„É≥„ÉÄ„Éº„Éê„Éº„Éâ", "„Ç∞„É¨„Éº„Éà„Éª„Çπ„Éî„É™„ÉÉ„Éà", "„Éì„Ç∏„Éß„É≥„Éª„ÇØ„Ç®„Çπ„Éà", "ËÅñ„Å™„ÇãÂãïÁâ©"],
                color: "#00b8d4"
            },
            aboriginal: {
                title: "Aboriginal Dreamtime",
                titleZh: "Êæ≥Ê¥≤Âéü‰ΩèÊ∞ëÊ¢¶Êó∂‰ª£",
                titleJa: "„Ç¢„Éú„É™„Ç∏„Éã„Éª„Éâ„É™„Éº„É†„Çø„Ç§„É†",
                origin: "Australia",
                originJa: "„Ç™„Éº„Çπ„Éà„É©„É™„Ç¢",
                description: "The Dreamtime stories that explain the creation of the land, animals, and people of Australia.",
                descriptionJa: "„Ç™„Éº„Çπ„Éà„É©„É™„Ç¢„ÅÆÂ§ßÂú∞„ÄÅÂãïÁâ©„ÄÅ‰∫∫„ÄÖ„ÅÆÂâµÈÄ†„ÇíË™¨Êòé„Åô„Çã„Éâ„É™„Éº„É†„Çø„Ç§„É†„ÅÆÁâ©Ë™û„ÄÇÊôÇÈñì„Å®Á©∫Èñì„ÇíË∂ÖË∂ä„Åó„ÅüÁ•ûËÅñ„Å™„Çã‰∏ñÁïåË¶≥„Åß„Åô„ÄÇ",
                features: ["Rainbow Serpent", "Dreamtime", "Songlines", "Creation Ancestors", "Sacred Sites"],
                featuresJa: ["ËôπËõá", "„Éâ„É™„Éº„É†„Çø„Ç§„É†", "„ÇΩ„É≥„Ç∞„É©„Ç§„É≥", "ÂâµÈÄ†„ÅÆÁ•ñÂÖà", "ËÅñÂú∞"],
                color: "#22a6b3"
            },
            polynesian: {
                title: "Polynesian Mythology",
                titleZh: "Ê≥¢Âà©Â∞ºË•ø‰∫öÁ•ûËØù",
                titleJa: "„Éù„É™„Éç„Ç∑„Ç¢Á•ûË©±",
                origin: "Pacific Islands",
                originJa: "Â§™Âπ≥Ê¥ãË´∏Â≥∂",
                description: "Ocean-spanning myths from Hawaii, Tahiti, New Zealand, and other Pacific islands.",
                descriptionJa: "„Éè„ÉØ„Ç§„ÄÅ„Çø„Éí„ÉÅ„ÄÅ„Éã„É•„Éº„Ç∏„Éº„É©„É≥„Éâ„Å™„Å©Â§™Âπ≥Ê¥ãË´∏Â≥∂„ÅÆÊµ∑„ÇíË∂ä„Åà„ÅüÁ•ûË©±„ÄÇÂ§ßÊµ∑Âéü„ÇíËàûÂè∞„Å´„Åó„ÅüÂ£ÆÂ§ß„Å™ÂÜíÈô∫„Å®Á•û„ÄÖ„ÅÆÁâ©Ë™û„Åß„Åô„ÄÇ",
                features: ["Maui", "Pele", "Tangaroa", "Tiki", "Ocean Voyages"],
                featuresJa: ["„Éû„Ç¶„Ç§", "„Éö„É¨", "„Çø„É≥„Ç¨„É≠„Ç¢", "„ÉÜ„Ç£„Ç≠", "Êµ∑Ê¥ãËà™Êµ∑"],
                color: "#30e3ca"
            }
        };

        // Language translations
        const translations = {
            en: {
                title: "Journey Through World Mythologies",
                subtitle: "Click on any region to explore its mythological treasures",
                search: "Search mythologies...",
                explore: "Explore",
                about: "About World Mythology Explorer",
                aboutText1: "Embark on a journey through the rich tapestry of human imagination. From the ancient tales of Mesopotamia to the vibrant stories of the Pacific Islands, explore how different cultures have explained the mysteries of existence through mythology.",
                aboutText2: "Each mythology represents not just stories, but the soul of a civilization - their values, fears, hopes, and understanding of the cosmos. Click on any region to discover its mythological heritage."
            },
            zh: {
                title: "‰∏ñÁïåÁ•ûËØù‰πãÊóÖ",
                subtitle: "ÁÇπÂáª‰ªªÊÑèÂú∞Âå∫Êé¢Á¥¢ÂÖ∂Á•ûËØùÂÆùËóè",
                search: "ÊêúÁ¥¢Á•ûËØù...",
                explore: "Êé¢Á¥¢",
                about: "ÂÖ≥‰∫é‰∏ñÁïåÁ•ûËØùÊé¢Á¥¢ËÄÖ",
                aboutText1: "Ë∏è‰∏ä‰∫∫Á±ªÊÉ≥Ë±°Âäõ‰∏∞ÂØåÁªáÈî¶ÁöÑÊóÖÁ®ã„ÄÇ‰ªéÁæéÁ¥¢‰∏çËææÁ±≥‰∫öÁöÑÂè§ËÄÅ‰º†ËØ¥Âà∞Â§™Âπ≥Ê¥ãÂ≤õÂ±øÁöÑÁîüÂä®ÊïÖ‰∫ãÔºåÊé¢Á¥¢‰∏çÂêåÊñáÂåñÂ¶Ç‰ΩïÈÄöËøáÁ•ûËØùËß£ÈáäÂ≠òÂú®ÁöÑÂ••Áßò„ÄÇ",
                aboutText2: "ÊØè‰∏™Á•ûËØù‰∏ç‰ªÖ‰ª£Ë°®ÊïÖ‰∫ãÔºåÊõ¥‰ª£Ë°®‰∏Ä‰∏™ÊñáÊòéÁöÑÁÅµÈ≠Ç‚Äî‚Äî‰ªñ‰ª¨ÁöÑ‰ª∑ÂÄºËßÇ„ÄÅÊÅêÊÉß„ÄÅÂ∏åÊúõÂíåÂØπÂÆáÂÆôÁöÑÁêÜËß£„ÄÇÁÇπÂáª‰ªªÊÑèÂú∞Âå∫ÂèëÁé∞ÂÖ∂Á•ûËØùÈÅó‰∫ß„ÄÇ"
            },
            ja: {
                title: "‰∏ñÁïåÁ•ûË©±„ÅÆÊóÖ",
                subtitle: "Âú∞Âüü„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Á•ûË©±„ÅÆÂÆùÁâ©„ÇíÊé¢Á¥¢",
                search: "Á•ûË©±„ÇíÊ§úÁ¥¢...",
                explore: "Êé¢Á¥¢",
                about: "‰∏ñÁïåÁ•ûË©±„Ç®„ÇØ„Çπ„Éó„É≠„Éº„É©„Éº„Å´„Å§„ÅÑ„Å¶",
                aboutText1: "‰∫∫Èñì„ÅÆÊÉ≥ÂÉèÂäõ„ÅÆË±ä„Åã„Å™„Çø„Éö„Çπ„Éà„É™„Éº„ÇíÊóÖ„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ„É°„ÇΩ„Éù„Çø„Éü„Ç¢„ÅÆÂè§‰ª£„ÅÆÁâ©Ë™û„Åã„ÇâÂ§™Âπ≥Ê¥ãË´∏Â≥∂„ÅÆÈÆÆ„ÇÑ„Åã„Å™Áâ©Ë™û„Åæ„Åß„ÄÅ„Åï„Åæ„Åñ„Åæ„Å™ÊñáÂåñ„ÅåÁ•ûË©±„ÇíÈÄö„Åò„Å¶Â≠òÂú®„ÅÆÁ•ûÁßò„Çí„Å©„ÅÆ„Çà„ÅÜ„Å´Ë™¨Êòé„Åó„Å¶„Åç„Åü„Åã„ÇíÊé¢„Çä„Åæ„Åô„ÄÇ",
                aboutText2: "ÂêÑÁ•ûË©±„ÅØÂçò„Å™„ÇãÁâ©Ë™û„Åß„ÅØ„Å™„Åè„ÄÅÊñáÊòé„ÅÆÈ≠Ç„ÇíË°®„Åó„Å¶„ÅÑ„Åæ„Åô - ÂΩº„Çâ„ÅÆ‰æ°ÂÄ§Ë¶≥„ÄÅÊÅê„Çå„ÄÅÂ∏åÊúõ„ÄÅ„Åù„Åó„Å¶ÂÆáÂÆô„Å∏„ÅÆÁêÜËß£„ÄÇ‰ªªÊÑè„ÅÆÂú∞Âüü„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„ÄÅ„Åù„ÅÆÁ•ûË©±„ÅÆÈÅ∫Áî£„ÇíÁô∫Ë¶ã„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ"
            }
        };

        let currentLang = 'ja';
        let activeCard = null;
        let canvas, ctx;
        let mapImage;
        let canvasWidth, canvasHeight;

        // Initialize canvas and load map
        function initializeMap() {
            canvas = document.getElementById('worldMapCanvas');
            ctx = canvas.getContext('2d');
            
            // Create world map image
            mapImage = new Image();
            mapImage.onload = function() {
                // Set canvas size
                const maxWidth = 1200;
                const aspectRatio = mapImage.height / mapImage.width;
                canvasWidth = Math.min(maxWidth, window.innerWidth - 80);
                canvasHeight = canvasWidth * aspectRatio;
                
                canvas.width = canvasWidth;
                canvas.height = canvasHeight;
                
                // Draw map with overlay
                drawMap();
                
                // Create markers
                createMythologyMarkers();
                
                // Create connection lines
                createConnectionLines();
            };
            
            // Use a stylized world map image (we'll create a gradient-based one)
            createStylizedWorldMap();
        }

        // Create a stylized world map using canvas
        function createStylizedWorldMap() {
            const tempCanvas = document.createElement('canvas');
            tempCanvas.width = 1200;
            tempCanvas.height = 600;
            const tempCtx = tempCanvas.getContext('2d');
            
            // Create gradient background
            const gradient = tempCtx.createLinearGradient(0, 0, 1200, 600);
            gradient.addColorStop(0, '#1a1a2e');
            gradient.addColorStop(0.5, '#16213e');
            gradient.addColorStop(1, '#0f3460');
            tempCtx.fillStyle = gradient;
            tempCtx.fillRect(0, 0, 1200, 600);
            
            // Draw simplified continents
            tempCtx.fillStyle = 'rgba(255, 255, 255, 0.1)';
            tempCtx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            tempCtx.lineWidth = 2;
            
            // Draw continents (simplified shapes)
            drawContinents(tempCtx);
            
            // Set the map image
            mapImage.src = tempCanvas.toDataURL();
        }

        // Draw simplified continent shapes
        function drawContinents(ctx) {
            // Africa
            ctx.beginPath();
            ctx.moveTo(600, 280);
            ctx.quadraticCurveTo(650, 260, 680, 290);
            ctx.quadraticCurveTo(700, 350, 680, 420);
            ctx.quadraticCurveTo(650, 480, 600, 500);
            ctx.quadraticCurveTo(550, 480, 520, 420);
            ctx.quadraticCurveTo(500, 350, 520, 290);
            ctx.quadraticCurveTo(550, 260, 600, 280);
            ctx.fill();
            ctx.stroke();
            
            // Europe
            ctx.beginPath();
            ctx.moveTo(600, 280);
            ctx.quadraticCurveTo(580, 220, 600, 160);
            ctx.quadraticCurveTo(620, 140, 650, 150);
            ctx.quadraticCurveTo(680, 160, 700, 180);
            ctx.quadraticCurveTo(680, 220, 650, 250);
            ctx.quadraticCurveTo(620, 270, 600, 280);
            ctx.fill();
            ctx.stroke();
            
            // Asia
            ctx.beginPath();
            ctx.moveTo(700, 180);
            ctx.quadraticCurveTo(800, 160, 900, 180);
            ctx.quadraticCurveTo(1000, 200, 1050, 250);
            ctx.quadraticCurveTo(1000, 350, 900, 400);
            ctx.quadraticCurveTo(800, 420, 700, 400);
            ctx.quadraticCurveTo(680, 350, 700, 300);
            ctx.quadraticCurveTo(700, 250, 700, 180);
            ctx.fill();
            ctx.stroke();
            
            // Americas
            ctx.beginPath();
            ctx.moveTo(200, 150);
            ctx.quadraticCurveTo(250, 140, 300, 160);
            ctx.quadraticCurveTo(350, 200, 350, 300);
            ctx.quadraticCurveTo(350, 400, 300, 450);
            ctx.quadraticCurveTo(250, 480, 200, 470);
            ctx.quadraticCurveTo(150, 450, 150, 400);
            ctx.quadraticCurveTo(150, 300, 150, 200);
            ctx.quadraticCurveTo(150, 160, 200, 150);
            ctx.fill();
            ctx.stroke();
            
            // Australia
            ctx.beginPath();
            ctx.moveTo(900, 450);
            ctx.quadraticCurveTo(950, 440, 1000, 460);
            ctx.quadraticCurveTo(1020, 500, 1000, 540);
            ctx.quadraticCurveTo(950, 560, 900, 550);
            ctx.quadraticCurveTo(850, 540, 850, 500);
            ctx.quadraticCurveTo(850, 460, 900, 450);
            ctx.fill();
            ctx.stroke();
        }

        // Draw the map with overlay
        function drawMap() {
            // Clear canvas
            ctx.clearRect(0, 0, canvasWidth, canvasHeight);
            
            // Draw base map
            ctx.drawImage(mapImage, 0, 0, canvasWidth, canvasHeight);
            
            // Add mystical overlay
            const overlay = ctx.createRadialGradient(canvasWidth/2, canvasHeight/2, 0, canvasWidth/2, canvasHeight/2, canvasWidth/2);
            overlay.addColorStop(0, 'rgba(102, 126, 234, 0.1)');
            overlay.addColorStop(0.5, 'rgba(118, 75, 162, 0.05)');
            overlay.addColorStop(1, 'transparent');
            ctx.fillStyle = overlay;
            ctx.fillRect(0, 0, canvasWidth, canvasHeight);
        }

        // Create mythology markers
        function createMythologyMarkers() {
            const markersContainer = document.getElementById('mythologyMarkers');
            markersContainer.innerHTML = '';
            
            Object.entries(mythologyLocations).forEach(([key, location], index) => {
                const marker = createMarker(key, location, index);
                markersContainer.appendChild(marker);
            });
        }

        // Create individual marker
        function createMarker(mythKey, location, index) {
            const marker = document.createElement('div');
            marker.className = 'mythology-marker';
            marker.dataset.mythology = mythKey;
            marker.style.setProperty('--marker-index', index);
            
            const x = location.x * canvasWidth;
            const y = location.y * canvasHeight;
            
            marker.style.left = x + 'px';
            marker.style.top = y + 'px';
            
            const markerInner = document.createElement('div');
            markerInner.className = 'marker-inner';
            
            const glow = document.createElement('div');
            glow.className = 'marker-glow';
            glow.style.background = `radial-gradient(circle, ${mythologyData[mythKey].color}88 0%, transparent 70%)`;
            
            const pin = document.createElement('div');
            pin.className = 'marker-pin';
            pin.style.background = `radial-gradient(circle, ${mythologyData[mythKey].color} 30%, transparent 70%)`;
            
            const label = document.createElement('div');
            label.className = 'marker-label';
            label.textContent = location.name;
            
            markerInner.appendChild(glow);
            markerInner.appendChild(pin);
            markerInner.appendChild(label);
            marker.appendChild(markerInner);
            
            // Add click event
            marker.addEventListener('click', () => {
                if (activeCard === mythKey) {
                    closeCard(mythKey);
                } else {
                    showMythologyCard(mythKey);
                }
            });
            
            return marker;
        }

        // Create connection lines between related mythologies
        function createConnectionLines() {
            const connections = [
                ['china', 'japan'],
                ['greece', 'egypt'],
                ['norse', 'celtic'],
                ['aztecMaya', 'nativeAmerican'],
                ['india', 'mesopotamia']
            ];
            
            const linesContainer = document.getElementById('connectionLines');
            linesContainer.innerHTML = '';
            
            connections.forEach(([from, to]) => {
                const line = createConnectionLine(from, to);
                if (line) linesContainer.appendChild(line);
            });
        }

        // Create connection line between two mythologies
        function createConnectionLine(from, to) {
            const fromLoc = mythologyLocations[from];
            const toLoc = mythologyLocations[to];
            
            if (!fromLoc || !toLoc) return null;
            
            const x1 = fromLoc.x * canvasWidth;
            const y1 = fromLoc.y * canvasHeight;
            const x2 = toLoc.x * canvasWidth;
            const y2 = toLoc.y * canvasHeight;
            
            const line = document.createElement('div');
            line.className = 'connection-line';
            line.dataset.from = from;
            line.dataset.to = to;
            
            const distance = Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);
            const angle = Math.atan2(y2 - y1, x2 - x1) * (180 / Math.PI);
            
            line.style.width = distance + 'px';
            line.style.left = x1 + 'px';
            line.style.top = y1 + 'px';
            line.style.transform = `rotate(${angle}deg)`;
            
            return line;
        }

        // Initialize particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.width = Math.random() * 10 + 5 + 'px';
                particle.style.height = particle.style.width;
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (Math.random() * 20 + 20) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Create mythology card
        function createMythologyCard(regionData, region) {
            const card = document.createElement('div');
            card.className = 'mythology-card';
            card.id = `card-${region}`;
            
            const title = currentLang === 'zh' ? regionData.titleZh : 
                         currentLang === 'ja' ? regionData.titleJa : 
                         regionData.title;
            
            const origin = currentLang === 'zh' ? (regionData.originZh || regionData.origin) :
                          currentLang === 'ja' ? (regionData.originJa || regionData.origin) :
                          regionData.origin;
            
            const description = currentLang === 'zh' ? (regionData.descriptionZh || regionData.description) :
                               currentLang === 'ja' ? (regionData.descriptionJa || regionData.description) :
                               regionData.description;
            
            const features = currentLang === 'zh' ? (regionData.featuresZh || regionData.features) :
                            currentLang === 'ja' ? (regionData.featuresJa || regionData.features) :
                            regionData.features;
            
            card.innerHTML = `
                <button class="close-card" onclick="closeCard('${region}')">‚úï</button>
                <h3>${title}</h3>
                <div class="mythology-origin">${origin}</div>
                <div class="mythology-description">${description}</div>
                <div class="mythology-features">
                    ${features.map(feature => `<span class="feature-tag">${feature}</span>`).join('')}
                </div>
                <button class="explore-btn" onclick="exploreMythology('${region}')">${translations[currentLang].explore}</button>
            `;
            
            return card;
        }

        // Position card near marker
        function positionCard(card, region) {
            const marker = document.querySelector(`[data-mythology="${region}"]`);
            const rect = marker.getBoundingClientRect();
            const mapContainer = document.querySelector('.map-container');
            const mapRect = mapContainer.getBoundingClientRect();
            
            card.style.left = (rect.left - mapRect.left + rect.width / 2 - 175) + 'px';
            card.style.top = (rect.top - mapRect.top + rect.height) + 'px';
            
            // Adjust if card goes off screen
            const cardRect = card.getBoundingClientRect();
            if (cardRect.right > window.innerWidth - 20) {
                card.style.left = (window.innerWidth - mapRect.left - 370) + 'px';
            }
            if (cardRect.bottom > window.innerHeight - 20) {
                card.style.top = (rect.top - mapRect.top - cardRect.height - 20) + 'px';
            }
        }

        // Show mythology card
        function showMythologyCard(region) {
            // Close any open card
            if (activeCard) {
                closeCard(activeCard);
            }
            
            const regionData = mythologyData[region];
            if (!regionData) return;
            
            const cardsContainer = document.getElementById('mythologyCards');
            const card = createMythologyCard(regionData, region);
            cardsContainer.appendChild(card);
            
            // Position and show card
            setTimeout(() => {
                positionCard(card, region);
                card.classList.add('show');
                // Show connection lines for this mythology
                showConnectionLines(region);
                // Add active class to marker
                document.querySelector(`[data-mythology="${region}"]`).classList.add('active');
            }, 10);
            
            activeCard = region;
        }

        // Close card
        function closeCard(region) {
            const card = document.getElementById(`card-${region}`);
            if (card) {
                card.classList.remove('show');
                setTimeout(() => card.remove(), 400);
            }
            // Remove active class from marker
            document.querySelector(`[data-mythology="${region}"]`)?.classList.remove('active');
            // Hide connection lines
            hideConnectionLines();
            if (activeCard === region) {
                activeCard = null;
            }
        }

        // Show connection lines for a mythology
        function showConnectionLines(mythology) {
            document.querySelectorAll('.connection-line').forEach(line => {
                if (line.dataset.from === mythology || line.dataset.to === mythology) {
                    line.classList.add('show');
                }
            });
        }

        // Hide all connection lines
        function hideConnectionLines() {
            document.querySelectorAll('.connection-line').forEach(line => {
                line.classList.remove('show');
            });
        }

        // Language switching
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentLang = this.getAttribute('data-lang');
                updateLanguage();
            });
        });

        // Update language
        function updateLanguage() {
            document.getElementById('mainTitle').textContent = translations[currentLang].title;
            document.getElementById('subtitle').textContent = translations[currentLang].subtitle;
            document.getElementById('searchInput').placeholder = translations[currentLang].search;
            document.querySelector('.about-section h2').textContent = translations[currentLang].about;
            
            const aboutContent = document.querySelector('.about-content');
            aboutContent.innerHTML = `
                <p>${translations[currentLang].aboutText1}</p>
                <p>${translations[currentLang].aboutText2}</p>
            `;
            
            // Update any open card
            if (activeCard) {
                const oldCard = document.getElementById(`card-${activeCard}`);
                const regionData = mythologyData[activeCard];
                const newCard = createMythologyCard(regionData, activeCard);
                
                oldCard.parentNode.replaceChild(newCard, oldCard);
                positionCard(newCard, activeCard);
                newCard.classList.add('show');
            }
        }

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            
            document.querySelectorAll('.mythology-marker').forEach(marker => {
                const mythologyKey = marker.dataset.mythology;
                const mythologyData_ = mythologyData[mythologyKey];
                
                const searchableText = [
                    mythologyData_.title,
                    mythologyData_.titleZh,
                    mythologyData_.titleJa,
                    mythologyData_.origin,
                    mythologyData_.description,
                    ...mythologyData_.features
                ].join(' ').toLowerCase();
                
                if (searchableText.includes(searchTerm)) {
                    marker.style.opacity = '1';
                    marker.style.pointerEvents = 'auto';
                } else {
                    marker.style.opacity = '0.3';
                    marker.style.pointerEvents = 'none';
                }
            });
            
            // Reset if search is empty
            if (!searchTerm) {
                document.querySelectorAll('.mythology-marker').forEach(marker => {
                    marker.style.opacity = '';
                    marker.style.pointerEvents = '';
                });
            }
        });

        // Explore mythology function
        function exploreMythology(region) {
            const mythologyPages = {
                china: 'chinese-mythology-index.html',
                greece: 'greek-mythology-reader.html',
                norse: 'norse-mythology-reader.html',
                // These will be created next:
                // egypt: 'egyptian-mythology-reader.html',
                // india: 'indian-mythology-reader.html',
                japan: 'japanese-mythology-index.html',
                // mesopotamia: 'mesopotamian-mythology-reader.html',
                // celtic: 'celtic-mythology-reader.html',
                // aztecMaya: 'aztec-maya-mythology-reader.html',
                // nativeAmerican: 'native-american-mythology-reader.html',
                // westAfrica: 'west-african-mythology-reader.html',
                // aboriginal: 'aboriginal-mythology-reader.html',
                // polynesian: 'polynesian-mythology-reader.html'
            };
            
            if (mythologyPages[region]) {
                window.location.href = mythologyPages[region];
            } else {
                alert(`${mythologyData[region].title} coming soon!`);
            }
        }

        // Initialize
        createParticles();
        initializeMap();

        // Handle window resize
        window.addEventListener('resize', () => {
            if (mapImage && mapImage.complete) {
                const maxWidth = 1200;
                const aspectRatio = mapImage.height / mapImage.width;
                canvasWidth = Math.min(maxWidth, window.innerWidth - 80);
                canvasHeight = canvasWidth * aspectRatio;
                
                canvas.width = canvasWidth;
                canvas.height = canvasHeight;
                
                drawMap();
                createMythologyMarkers();
                createConnectionLines();
                
                // Reposition active card if any
                if (activeCard) {
                    const card = document.getElementById(`card-${activeCard}`);
                    if (card) {
                        positionCard(card, activeCard);
                    }
                }
            }
        });

        // Close card when clicking outside
        document.addEventListener('click', function(e) {
            if (activeCard && !e.target.closest('.mythology-card') && !e.target.closest('.mythology-marker')) {
                closeCard(activeCard);
            }
        });

        // Prevent card close when clicking inside card
        document.addEventListener('click', function(e) {
            if (e.target.closest('.mythology-card') && !e.target.closest('.close-card')) {
                e.stopPropagation();
            }
        });

        // Animation on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -100px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        // Observe elements for scroll animations
        document.querySelectorAll('.legend-item, .about-section').forEach(el => {
            el.style.opacity = '0';
            el.style.transform = 'translateY(20px)';
            el.style.transition = 'all 0.6s ease';
            observer.observe(el);
        });
    </script>
</body>
</html>